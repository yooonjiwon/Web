package com.seoul.service;

import java.util.ArrayList;
import java.util.List;

import com.seoul.dao.ContactsBoardDao;
import com.seoul.dto.ContactsAttach;
import com.seoul.dto.ContactsBoard;
import com.seoul.dto.ContactsComment;

public class ContactsBoardService {

	public List<ContactsBoard> findBoardList() {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		List<ContactsBoard> boards = boardDao.selectBoard();
		return boards;
	}

	public ContactsBoard findBoardByBoardNo(int boardNo) {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		ContactsBoard board = boardDao.selectBoardByBoardNo(boardNo);
		ArrayList<ContactsAttach> attachments = 
		boardDao.selectBoardAttachByBoardNo(boardNo);
		board.setAttachments(attachments);
		ArrayList<ContactsComment> comments = 
				boardDao.selectCommentByBoardNo(boardNo);
		board.setComments(comments);
		return board;
	}
	
	public List<ContactsBoard> findBoardList(int first, int last) {
		ContactsBoardDao dao = new ContactsBoardDao();
		List<ContactsBoard> boards = dao.selectBoardList2(first, last);
		return boards;
	}
	
	public int getBoardCount() {
		ContactsBoardDao dao = new ContactsBoardDao();
		int count = dao.getBoardCount();
		return count;
	}
	
	public void increaseReadCount(int boardNo) {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		boardDao.updateReadCount(boardNo);		
	}
	
	public void updateBoard(ContactsBoard board) {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		boardDao.updateBoard(board);
		
	}
	
	public int writeBoard1(ContactsBoard board) {
		ContactsBoardDao dao = new ContactsBoardDao();
		int newBoardNo = dao.insertBoard1(board);
		return newBoardNo;
	}

	public void writeBoard2(ContactsBoard board) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.insertBoard2(board);
		
	}
	
	public void writeBoard3(ContactsBoard board) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.insertBoard3(board);
		
	}
	
	public void writeBoard4(ContactsBoard board) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.insertBoard4(board);
		
	}
	
	public void deleteBoard(int boardNo) {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		boardDao.deleteBoard(boardNo);		
	}
	
	public void writeComment(ContactsComment comment) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.insertComment(comment);
	}

	public void saveBoardAttach(ContactsAttach attachment) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.insertBoardAttach(attachment);		
	}

	public void replyBoard(ContactsBoard board) {
		ContactsBoardDao boardDao = new ContactsBoardDao();
		//원 글의 정보 조회
		ContactsBoard parent = boardDao.selectBoardByBoardNo(board.getBoardNo());
		
		//같은 그룹에 포함된 기존 글의 순서번호(step) 증가
		boardDao.updateStep(parent.getGroupNo(), parent.getStep());
		
		board.setGroupNo(parent.getGroupNo());
		board.setStep(parent.getStep() + 1);
		board.setDepth(parent.getDepth() + 1);
		boardDao.insertReply1(board);		
		
	}

	public ContactsAttach findBoardAttachByAttachNo(int attachNo) {
		ContactsBoardDao dao = new ContactsBoardDao();
		ContactsAttach attachment = 
				dao.selectBoardAttachByAttachNo(attachNo);
		return attachment;
	}

	public void updateComment(ContactsComment comment) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.updateComment(comment);
	}

	public void deleteComment(int commentNo) {
		ContactsBoardDao dao = new ContactsBoardDao();
		dao.deleteComment(commentNo);
		
	}

	

}
